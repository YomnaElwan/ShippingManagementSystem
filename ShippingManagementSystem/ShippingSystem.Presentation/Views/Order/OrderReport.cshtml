@using ShippingSystem.Domain.Entities
@model List<OrderStatus>
@{
    ViewData["Title"] = "OrderReport";
    SelectList orderStatusList = new SelectList(Model, "Id", "Name");
}

<div class="container mt-4">
    <div class="row g-3 align-items-end">
        <div class="col-md-2 col-sm-6">
            <label for="orderSts" class="form-label text-white">Order Status</label>
            <select class="form-select" id="orderSts">
                <option value="0">--Select Order Status--</option>
                <option value="all">All</option>
                @foreach (var option in Model)
                {
                    <option value="@option.Id">@option.Name</option>
                }
            </select>
        </div>

        <div class="col-md-2 col-sm-6">
            <label for="fromDate" class="form-label text-white">From Date</label>
            <input type="date" class="form-control" id="fromDate" />
        </div>

        <div class="col-md-2 col-sm-6">
            <label for="toDate" class="form-label text-white">To Date</label>
            <input type="date" class="form-control" id="toDate" />
        </div>

        <div class="col-md-2 col-sm-6 d-flex justify-content-md-start justify-content-sm-center">
            <button id="filterBtn" class="btn btn-primary w-100">Search</button>
        </div>
    </div>
</div>


<div class="table-responsive mt-3">
    <table class="table table-hover table-bordered align-middle text-center bg-light bg-opacity-75 shadow-sm">
        <thead class="table-primary">
            <tr>
                <th>Id</th>
                <th>Status</th>
                <th>Merchant Name</th>
                <th>Customer Name</th>
                <th>Customer Number</th>
                <th>Governorate</th>
                <th>City</th>
                <th>Total Cost</th>
                <th>Delivered Amount</th>
                <th>Delivery Cost</th>
                <th>Delivered Delivery Cost</th>
                <th>Company Percent</th>
                <th>Order Date</th>
            </tr>
        </thead>
        <tbody id="tableId">
          
        </tbody>
    </table>
</div>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/dist/jquery.validate.unobtrusive.min.js"></script>

<script>
    $(document).ready(function(){
        var tableElement=$("#tableId");
        $("#orderSts").change(function(){
            let selectedVal=$(this).val();
            if(selectedVal==='all'){
                $.ajax({
                    url:'/Order/OrderReportForAll',
                    type:'GET',
                    success:function(result){
                        tableElement.html(result);
                    },
                    error:function(){
                        tableElement.html(`
                        <tr><td colspan="13" class="text-danger">No data available in this table</td></tr>`
                        );
                    }
                
                });
            }
            else if(selectedVal !=='0'){
                $.ajax({
                    url:'/Order/GetOrdersByStsId',
                    type:'GET',
                    data:{orderStsId:selectedVal},
                    cache:false,
                    success:function(result){
                        tableElement.html(result);
                    },
                    error:function(){
                        tableElement.html(`
                        <tr><td colspan="13" class="text-danger">No data available in this table</td></tr>`
                        );
                    }

                });
            }
        });
    });
</script>
